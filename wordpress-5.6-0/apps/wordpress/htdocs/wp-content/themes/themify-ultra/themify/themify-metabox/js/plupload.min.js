'use strict';function themify_create_pluploader(c){var d=c.attr("id").replace("plupload-upload-ui",""),k=!1,l=!1,b=jQuery,a=JSON.parse(JSON.stringify(global_plupload_init));a.browse_button=d+a.browse_button;a.container=d+a.container;a.drop_element=d+a.drop_element;a.file_data_name=d+a.file_data_name;a.multipart_params.imgid=d;a.multipart_params._ajax_nonce=c.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu","");c.hasClass("add-preset")&&(k=!0,a.multipart_params.haspreset="haspreset");c.hasClass("add-preview")&&
(l=!0,a.multipart_params.haspreview="haspreview");c.hasClass("add-to-media")&&(a.multipart_params.tomedia="tomedia");c.data("postid")&&(a.multipart_params.topost=c.data("postid"));c.data("fields")&&(a.multipart_params.fields=c.data("fields"));c.data("featured")&&(a.multipart_params.featured=c.data("featured"));c.data("formats")&&(a.filters[0].extensions=c.data("formats"));a.multipart_params.action=c.data("action");a=new plupload.Uploader(a);a.bind("Init",function(a){});a.init();a.bind("FilesAdded",
function(a,d){if(!c.data("confirm")||confirm(c.data("confirm")))a.refresh(),a.start(),b(".tb_alert").addClass("busy").fadeIn(800)});a.bind("Error",function(a,c){b(".prompt-box .show-login").hide();b(".prompt-box .show-error").show();if(-600==c.code)var m=themify_plupload_lang.filesize_error,d=themify_plupload_lang.filesize_error_fix;0<b(".prompt-box .show-error").length&&(b(".prompt-box .show-error").html('<p class="prompt-error">'+m+"</p>"),d&&b(".prompt-box .show-error").append("<p>"+d+"</p>"));
b(".overlay, .prompt-box").fadeIn(500);document.getElementsByClassName("overlay")[0].addEventListener("click",function(){b(".overlay, .prompt-box").fadeOut(500)},{once:!0})});a.bind("FileUploaded",function(a,e,f){a=JSON.parse(f.response);var g="";g="200"!=f.status||a.error?"error":"done";b(".tb_alert").removeClass("busy").addClass(g).delay(800).fadeOut(800,function(){b(this).removeClass(g)});if(a.error)b(".prompt-box .show-login").hide(),b(".prompt-box .show-error").show(),0<b(".prompt-box .show-error").length&&
(b(".prompt-box .show-error").html('<p class="prompt-error">'+a.error+"</p>"),b(".prompt-box .show-error").append("<p>"+themify_plupload_lang.enable_zip_upload+"</p>")),b(".overlay, .prompt-box").fadeIn(500),document.getElementsByClassName("overlay")[0].addEventListener("click",function(){b(".overlay, .prompt-box").fadeOut(500)},{once:!0});else{b("#"+e.id).fadeOut();f=a.file;e=a.url;var h=a.type;"zip"===h||"rar"===h||"plain"===h?window.location=location.href.replace(location.hash,""):b("#"+d).val(e);
"undefined"!==typeof a.thumb&&(themifyMediaLib.setPreviewIcon(c.closest(".themify_field, .themify_field_row"),a.thumb),b("body").trigger("themify_plupload_selected",[c,a]));k&&(b("#"+d).closest("fieldset").children(".preset").find("img").removeClass("selected"),a=e.replace(/^.*[\\\/]/,""),a=b('<a href="#" title="'+a+'"><span title="'+f+'"></span><img src="'+e+'" alt="'+e+'" class="backgroundThumb selected" /></a>').css("display","inline-block"),b("#"+d).closest("fieldset").children(".preset").append(a));
l&&b("#"+d+"-preview").attr("src",e)}})}jQuery(document).ready(function(c){var d=c(".plupload-upload-uic");0<d.length&&d.each(function(){themify_create_pluploader(c(this))})});
